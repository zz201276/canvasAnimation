class CA{constructor(option){this.option=option;this.imgArr=[];let canvas=document.getElementById(this.option.el);this.xtc=canvas.getContext('2d');this.CW;this.CH;this.creatImgList();this.fmer;this.frameIndex=0;this.framePlaying=false}creatImgList(){let THAT=this;(function(){for(let i=1;i<THAT.option.MaxL+1;i++){let img=new Image();img.onload=function(){THAT.imgArr[i-1]=img;img.setAttribute("crossOrigin",'anonymous');if(i===1){THAT.CW=img.width*THAT.option.dpr;THAT.CH=img.height*THAT.option.dpr;canvas.width=THAT.CW;canvas.height=THAT.CH;THAT.onRady()}};img.src=THAT.option.urllt+i+THAT.option.suffix}})()}onRady(){let THAT=this;this.xtc.fillRect(0,0,this.CW,this.CH);this.xtc.save();let ia=new Image();ia.onload=function(){THAT.xtc.drawImage(ia,0,0,THAT.CW,THAT.CH)};if(this.option.positer)ia.src=this.option.positerUrl;else this.xtc.drawImage(this.imgArr[0],0,0,THAT.CW,THAT.CH)}play(){if(this.framePlaying)return;this.framePlaying=true;this.fmer=setInterval(()=>{this.frameIndex++;this.xtc.clearRect(0,0,this.CW,this.CH);this.xtc.drawImage(this.imgArr[this.frameIndex],0,0,this.CW,this.CH);let RLT=0;if(this.option.replayLoopTo){RLT=this.option.replayLoopTo}else{RLT=this.imgArr.length-1}if(this.option.loop&&this.frameIndex==RLT){clearInterval(this.fmer);if(this.option.replayLoopFrom){this.frameIndex=this.option.replayLoopFrom}else{this.frameIndex=0}console.log(this.frameIndex);this.framePlaying=false;this.play()}else if(this.frameIndex==RLT){clearInterval(this.fmer);this.framePlaying=false;this.frameIndex=0}},1000/this.option.frame)}pause(){this.framePlaying=false;clearInterval(this.fmer)}frameI(){return this.frameIndex}}let CALOOP=new CA({urllt:'./src/images/x',suffix:'.jpg',MaxL:121,el:'canvas',dpr:.5,positer:true,positerUrl:'./src/images/x20.jpg',loop:true,frame:23,replayLoopFrom:50,replayLoopTo:70});document.querySelector('.play').onclick=function(){CALOOP.play(CALOOP.frameI())};document.querySelector('.pause').onclick=function(){CALOOP.pause()}